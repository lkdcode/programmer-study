# 드라이빙 오퍼레이션 허용을 위한 입력 어댑터 사용

'변하지 않는 사실은 모든 것은 변한다는 사실뿐이다.'<br/>
비즈니스 규칙과 기술적 세부사항이 연결되도록 시스템이 설계된 경우 새로운 기술의 통합은 상당한 양의 리팩터링 없이는 쉽지 않다.<br/>
헥사고날 아키텍처에서 입력 어댑터는 소프트웨어를 다른 기술들과 호환되게 만드는 요소다.<br/>

헥사곤 외부에는 헥사곤 애플리케이션과 상호작용하는 사용자나 시스템이 있을 수 있다.<br/>
이러한 사용자나 시스템을 가리켜 애플리케이션 유스케이스를 형성하는 중추적인 역할을 하는 주요 액터라고 한다.<br/>
주요 액터와 헥사고날 애플리케이션 사이의 상호작용은 입력 어댑터를 통해 일어난다.<br/>
이러한 상호작용은 드라이빙 오퍼레이션으로 정의된다.<br/>
주요 액터가 이들을 드라이브하고, 헥사고날 시스템의 상태와 행위를 시작하게 하고 영향을 준다는 의미에서 드라이빙으로 표현한다.<br/>

DDD 기반 아키텍처의 일반적인 관심사는 레거시 시스템의 요소를 새로운 시스템에 통합하는 것이다.<br/>
이것은 도메인 모델에서 관련 지식이 모인 레거시 시스템이 몇 가지 중요한 문제를 해결하지만 설계 불일치를 보여주는 상황에서 발생한다.<br/>
레거시 시스템을 포기하고 싶지 않지만 새로운 시스템 설계가 레거시 시스템의 설계에 영향을 주는 것도 원하지 않을 것이다.<br/>
**반부패 계층** 은 레거시 시스템과 새로운 시스템 모두에서 경계 컨텍스트를 통합하는 데 사용되는 어댑터를 기반으로 한다.<br/>

주요 액터와 헥사고날 애플리케이션 사이의 연결이 입력 어댑터를 통해 발생한다.<br/>

## 입력 어댑터 생성

**입력 포트 객체는 입력 어댑터가 보낸 자극을 통해 오퍼레이션을 수행하는 데 필요한 모든 데이터를 수신한다.**<br/>
그러나 입력 데이터를 도메인 헥사곤과 호환되는 형식으로 변환하기 위해 이 단계에서 최종적인 변환이 발생할 수 있다.<br/>

### 기반 어댑터

기반 어댑터를 추상 클래스 혹은 인터페이스로 작성한다.<br/>
이 기반 어댑터는 어댑터와 관련된 입력포트와 통신을 위한 표준 오퍼레이션을 제공한다.(REST API, STDIN, gRPC 등)<br/>

어댑터는 입력 포트를 직접 참조하지 않는다. 유스케이스 인터페이스 참조를 활용한다.<br/>
```java
RouterNetworkOutputPort outputPort = RouterNetworkH2Adpater.getInstance();
RouterNetworkUseCase usecase = new RouterNetworkInputPort(outputPort);
RouterNetworkAdapter inputAdpater = new RouterNetworkRestAdapter(usecase);
```

Rest 입력 어댑터가 결국 H2 인-메모리 데이터베이스 출력 어댑터를 필요로 한다는 것을 나타낸다.<br/>

```java
RouterNetworkOutputPort outputPort = RouterNetworkFileAdpater.getInstance();
RouterNetworkUseCase usecase = new RouterNetworkInputPort(outputPort);
RouterNetworkAdapter inputAdpater = new RouterNetworkCLIAdapter(usecase);
```

CLI 입력 어댑터가 결국 File 출력 어댑터가 필요로 한다는 것을 나타낸다.<br/>
이처럼 다양한 '정문'을 통해 애플리케이션 내부에 진입할 수 있는 통로를 생성할 수 있다.<br/>
입력 어댑터는 유스케이스 인터페이스 참조를 통해 입력 포트를 호출한다.<br/>

**입력 어댑터**는 헥사고날 애플리케이션이 제공하는 모든 기능에 액세스할 수 있는 정문에 해당한다.<br/>
입력 어댑터를 통해 비즈니스 로직을 방해하지 않으면서 다양한 기술을 통해 시스템에 쉽게 액세스할 수 있다.<br/>