# 4장 테스트 조직

## AAA로 테스트 일관성 유지

- 준비 (Arrange): 테스트 코드 실행전 세팅
- 실행 (Act): 테스트 코드 실행
- 단언 (Assert): 기대한 결과

- 사후 (After): 테스트 후 정리

## 동작 테스트 vs 메서드 테스트

테스트를 작성할 때는 클래스 동작에 집중해야 하며 개별 메서드를 테스트한다고 생각하면 안 된다.<br/>
ex. 모든 출금 테스트를 위해서는 먼저 입금할 필요가 있다.<br/>
단위 테스트를 작성할 때는 먼저 전체적인 시각에서 시작해야 한다.<br/>
개별 메서드가 아닌 클래스의 종합적인 동작을 테스트해야 한다.<br/>

## 내부 데이터 노출 vs 내부 동작 노출

private 메서드는 테스트하지 않는 것이 좋다.<br/>
내부 행위를 테스트하려는 충동이 든다면 설계에 문제가 있는 것이다.<br/>
SPR 을 어길 가능성이 높으며 다른 클래스의 메서드로 옮겨 문제를 해결할 수 있다.<br/>

## 집중적인 단일 목적 테스트의 가치

다수의 케이스를 별도의 테스트 메서드로 분리하라.<br/>
단언이 실패했을 때 실패한 테스트 내용이 직관적으로 보이기에 빠른 파악 가능.<br/>
각 테스트를 별도의 인스턴스로 실행하기 때문에 실패 테스트에 대해 다른 테스트에 영향을 제거할 수 있다.<br/>
모든 케이스가 실행되었음을 보장할 수 있다.(단언 실패시 현재 테스트 메서드는 중단되므로)<br/>

## 일관성 있는 이름으로 테스트 문서화

- 어떤 동작을 하면 어떤 결과가 나온다. (doingSomeOperationGenerateSomeResult)
- 어떤 결과는 어떤 조건에서 발생한다. (someResultOccursUnderSomeCondition)
- 주어진 조건에서 어떤 일을 하면 어떤 결과가 나온다. (givenSomeContextWhenDoingSomeBehaviorThenSomeResultOccurs)
- 어떤 일을 하면 어떤 결과가 나온다. (whenDoingSomeBehaviorThenSomeResultOccurs)

## 테스트를 의미 있게 만들기

테스트 파악이 어렵다면 주석을 추가하는 것외에 테스트 이름을 개선하자.

- 지역 변수 이름 개선하기
- 의미 있는 상수 도입하기
- 햄크레스트 단언 사용하기
- 커다란 테스트를 작게 나누어 집중적인 테스트 만들기
- 테스트 군더더기들을 도우미 메서드와 @Before 메서드로 이동하기

테스트 이름과 코드는 주석없이 스토리가 이해가 가능해야한다.