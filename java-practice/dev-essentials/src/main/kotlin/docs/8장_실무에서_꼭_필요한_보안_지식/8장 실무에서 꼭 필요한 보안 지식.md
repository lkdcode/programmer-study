# π”¥ 8μ¥ μ‹¤λ¬΄μ—μ„ κΌ­ ν•„μ”ν• λ³΄μ• μ§€μ‹

## π€ μ¤‘μ”ν• λ³΄μ•

`https://μ£Όμ†/...?cd=κ³ κ° μ½”λ“`  
λ΅κ·ΈμΈν• μ μ €λ” νΉλ³„ν• κ²€μ¦μ—†μ΄ κ³ κ° μ½”λ“λ¥Ό μ΅°νν•  μ μμ–΄μ„ κ³ κ° μ •λ³΄κ°€ μ μ¶λλ” λ³΄μ• μ‚¬κ³  μ‚¬λ΅€κ°€ μλ‹¤.  
λ¬΄μ‘μ„λ΅ λ§λ“  κ³ κ° μ½”λ“κ°€ μ‹¤μ  κ³ κ° μ½”λ“μ™€ μΌμΉν•λ©΄ ν•΄λ‹Ή κ³ κ°μ μ •λ³΄λ¥Ό μ·¨λ“ν•  μ μμ—λ‹¤.  

λ λ‹¤λ¥Έ μ‚¬λ΅€λ΅λ” API λ¥Ό νΈμ¶ν•  λ• νμ› μ‹λ³„μλ¥Ό μ „λ‹¬ν–λ”λ° μ΄ API λ” μ•”νΈ λ³€κ²½ API λ΅ νμ› μ‹λ³„μμ™€ λ³€κ²½ν•  μ•”νΈμ λ‘ νλΌλ―Έν„°λ¥Ό μ „λ‹¬λ°›μ•λ‹¤.  

- ν„μ¬ μ”μ²­μ΄ λ΅κ·ΈμΈν• νμ›μ μ”μ²­μΈμ§€ ν™•μΈν•μ§€ μ•μ
- νμ› μ‹λ³„μκ°€ λ΅κ·ΈμΈν• νμ›μ μ‹λ³„μμΈμ§€ κ²€μ¦ν•μ§€ μ•μ
- λ³€κ²½ν•μ§€ μ „ μ•”νΈλ¥Ό κ²€μ¦ν•μ§€ μ•μ

μ„ λ¬Έμ λ΅ μΈν•΄ API μ κµ¬μ΅°λ§ μ•λ©΄ λ„κµ¬λ‚ λ‹¤λ¥Έ νμ›μ μ•”νΈλ¥Ό λ³€κ²½ν•  μ μμ—λ‹¤.  
λ³΄μ• μ‚¬κ³ κ°€ λ°μƒν•  κ°€λ¥μ„±μ„ λ‚®μ¶”λ ¤λ©΄ μ„λ²„ κ°λ°μλ” κΈ°λ³Έμ μΈ λ³΄μ•μ— μ‹ κ²½ μ¨μ•Ό ν•λ‹¤.  

## π€ μΈμ¦κ³Ό μΈκ°€

- μΈμ¦<sup>authentication</sup>: μ‚¬μ©μκ°€ λ„κµ¬μΈμ§€ ν™•μΈ
- μΈκ°€<sup>authorization</sup>: μ‚¬μ©μμ—κ² μμ›μ— μ ‘κ·Όν•  μ μλ” κ¶ν•μ„ ν™•μΈ

### π― μΈμ¦κ³Ό ν† ν°

μ•„μ΄λ””μ™€ μ•”νΈλ¥Ό μ…λ ¥ν•λ” λ΅κ·ΈμΈμ€ μΈμ¦μ ν• ν•νƒμ΄λ‹¤. λ³΄μ•μ„ κ°•ν™”ν•κΈ° μ„ν•΄ 2λ‹¨κ³„ μΈμ¦<sup>Two-Factor-Authentication,2FA</sup>μ„ μ‚¬μ©ν•κΈ°λ„ ν•λ‹¤.  

```mermaid
sequenceDiagram
    ν΄λΌμ΄μ–ΈνΈ ->>+ μ„λ²„: 1: μΈμ¦ μ”μ²­
    μ„λ²„ ->> μ„λ²„: 1.1: μ•„μ΄λ””, μ•”νΈ ν™•μΈ
    μ„λ²„ ->> μ„λ²„: 1.2: ν† ν° μƒμ„±
    μ„λ²„ ->>- ν΄λΌμ΄μ–ΈνΈ: 1.3: μΈμ¦ μ„±κ³µ, ν† ν° μ „μ†΅
    ν΄λΌμ΄μ–ΈνΈ ->>+ μ„λ²„: 2: μ”μ²­(ν† ν° μ „μ†΅)
    μ„λ²„ ->> μ„λ²„: 2.1: ν† ν° κ²€μ¦ λ° μ‚¬μ©μ μ‹λ³„
    μ„λ²„ ->> μ„λ²„: 2.2: μ”μ²­ μ²λ¦¬
    μ„λ²„ ->>- ν΄λΌμ΄μ–ΈνΈ: 2.3: μ‘λ‹µ
```

μΈμ¦μ΄ ν•„μ”ν• κΈ°λ¥μ— λ€ν•΄ λ§¤λ² μ•„μ΄λ””μ™€ μ•”νΈλ¥Ό μ…λ ¥λ°›μ§€ μ•κ³  ν† ν°μ„ μ‚¬μ©ν•΄μ„ μ‚¬μ©μλ¥Ό μ‹λ³„ν•λ‹¤.  
ν† ν°κ³Ό μ‚¬μ©μ κ°„μ λ§¤ν•‘ μ •λ³΄λ¥Ό μ €μ¥ν•  μ„μΉλ΅λ” ν¬κ² λ‹¤μ 2κ°€μ§€λ¥Ό μ‚¬μ©ν•λ‹¤.  

- μ„λ²„μ λ³„λ„ μ €μ¥μ†: λ³„λ„ μ €μ¥μ†μ— ν† ν°κ³Ό μ‚¬μ©μ μ‹λ³„ μ •λ³΄λ¥Ό μ €μ¥ν•λ‹¤.
- ν† ν°: ν† ν° μμ²΄μ— μ‚¬μ©μ μ‹λ³„μ μ •λ³΄λ¥Ό μ €μ¥ν•λ‹¤.

### β… λ³„λ„ μ €μ¥μ†μ— ν† ν°κ³Ό μ‚¬μ©μ μ‹λ³„μ μ •λ³΄ μ €μ¥ν•κΈ°

μ„λ²„λ” ν† ν°κ³Ό μ‚¬μ©μ μ‹λ³„ μ •λ³΄λ¥Ό DBλ‚ λ λ””μ¤μ™€ κ°™μ€ λ³„λ„ μ €μ¥μ†μ— λ³΄κ΄€ν•  μ μλ‹¤.  

```mermaid
flowchart LR
    ν΄λΌμ΄μ–ΈνΈ -- 1: λ΅κ·ΈμΈ μ”μ²­ --> μ»¨νΈλ΅¤λ¬
    μ»¨νΈλ΅¤λ¬ -- 5: ν† ν° μ‘λ‹µ --> ν΄λΌμ΄μ–ΈνΈ
    subgraph μ„λ²„
        μ»¨νΈλ΅¤λ¬
        μΈμ¦_μ„λΉ„μ¤
        TokenStore
    end

    μ»¨νΈλ΅¤λ¬ -- 2: μ•„μ΄λ””, μ•”νΈ ν™•μΈ --> μΈμ¦_μ„λΉ„μ¤
    μ»¨νΈλ΅¤λ¬ -- 3: μƒ ν† ν° μƒμ„±/μ‚¬μ©μ μ‹λ³„μ μ „λ‹¬ --> TokenStore
    TokenStore -- 4:ν† ν° μ •λ³΄ μ €μ¥/ν† ν°, μ‚¬μ©μ μ‹λ³„μ --> μ €μ¥μ†
```

μ™Έλ¶€ μ €μ¥μ†μ— λ³΄κ΄€λλ” μ •λ³΄λ” ν† ν°, μ‚¬μ©μ μ‹λ³„μ, μƒμ„± μ‹κ°„, μµκ·Ό μ‚¬μ© μ‹κ°„, κ·Έ μ™Έ μ ν¨μ‹κ°„, ν΄λΌμ΄μ–ΈνΈ λ²„μ „ λ“±μ λ°μ΄ν„°λ¥Ό κ°–λ”λ‹¤.  
μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈκ°€ μ „μ†΅ν• ν† ν°μ„ μ΄μ©ν•΄μ„ μ €μ¥μ†μ—μ„ μ‚¬μ©μ μ‹λ³„μλ¥Ό κµ¬ν•λ‹¤.  

ν† ν° λ°μ΄ν„°λ” ν¬κΈ°κ°€ ν¬μ§€ μ•κΈ° λ•λ¬Έμ— μλ°±λ§ κ°μ ν† ν°μ„ μ €μ¥ν•΄λ„ DB μ©λ‰μ— ν° λ¶€λ‹΄μ€ μ—†λ‹¤.  
μ™Έλ¶€ μ €μ¥μ†κ°€ μ•„λ‹ μ„λ²„ λ©”λ¨λ¦¬μ— ν† ν° λ°μ΄ν„°λ¥Ό μ €μ¥ν•  μλ„ μλ‹¤. μ„λΈ”λ¦Ώ μ„Έμ…μ΄ μ΄μ— ν•΄λ‹Ήν•λ‹¤.  
ν†°μΊ£κ³Ό κ°™μ€ μ»¨ν…μ΄λ„λ” λ©”λ¨λ¦¬μ— μ„Έμ… κ°μ²΄λ¥Ό μ €μ¥ν•λ‹¤. μ„λΈ”λ¦΄ μ„Έμ…μ€ κ³ μ μ μ„Έμ… ID λ¥Ό μƒμ„±ν•λ”λ° μ΄ μ„Έμ… ID κ°€ ν† ν°μ— ν•΄λ‹Ήν•λ‹¤.  

λ©”λ¨λ¦¬μ— ν† ν° λ°μ΄ν„°λ¥Ό μ €μ¥ν•λ” λ°©μ‹μ„ μ‚¬μ©ν•  λ•λ” κ³ μ • μ„Έμ…<sup>sticky session</sup>μ΄ ν•„μ”ν•λ‹¤.  
λ¶„μ‚° ν™κ²½μ—μ„λ” λ΅λ“λ°Έλ°μ„λ¥Ό μ΄μ©ν•΄ κ³ μ • μ„Έμ… λ°©μ‹μΌλ΅ ν’€μ–΄λ‚Έλ‹¤.
λ©”λ¨λ¦¬λ” μ„λ²„ μ¬μ‹μ‘κ³Ό ν¬κΈ°μ— λ€ν• μ μ•½μ΄ μμ–΄ λ³„λ„ μ €μ¥μ†μ— λ³΄κ΄€ν•κΈ°λ„ ν•λ‹¤.  

### β… ν† ν° μμ²΄μ— μ‚¬μ©μ μ‹λ³„μ μ •λ³΄ μ €μ¥ν•κΈ°

λ€ν‘μ μΈ λ°©μ‹μ΄ JWT<sup>JSON-Web-Token</sup>κ°€ μλ‹¤.  
μ‚¬μ©μκ°€ λ΅κ·ΈμΈμ— μ„±κ³µν•λ©΄ μ‚¬μ©μ μ‹λ³„μλ¥Ό κ°’μΌλ΅ κ°–λ” JWT λ¥Ό μƒμ„±ν•΄μ„ ν΄λΌμ΄μ–ΈνΈμ— ν† ν°μΌλ΅ μ‘λ‹µν•λ‹¤.  

μ¥μ   
- ν† ν°λ§ μμΌλ©΄ μ‚¬μ©μκ°€ λ„κµ¬μΈμ§€ ν™•μΈν•  μ μλ‹¤.
- λ³„λ„μ μ™Έλ¶€ μ €μ¥μ†λ‚ λ©”λ¨λ¦¬μ— ν† ν° λ°μ΄ν„°λ¥Ό μ €μ¥ν•  ν•„μ”κ°€ μ—†λ‹¤.

λ‹¨μ 
- λ„¤νΈμ›ν¬ νΈλν”½μ΄ μ¦κ°€ν•λ‹¤. (μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈκ°€ μ£Όκ³ λ°›λ” λ°μ΄ν„°μ ν¬κΈ°κ°€ μ¦κ°€ν•λ―€λ΅)
- ν† ν°μ€ μ„λ²„μ—μ„ μ μ–΄ν•  μ μ—†λ‹¤.

### β… ν† ν° μ†΅μμ‹ 

ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ— ν† ν°μ„ μ „μ†΅ν•  λ• μ£Όλ΅ μΏ ν‚¤λ‚ ν—¤λ”λ΅ μ „μ†΅ν•λ‹¤.  

μ›Ή μ‚¬μ΄νΈλ” μ£Όλ΅ μΏ ν‚¤ λ°©μ‹μ„ μ‚¬μ©ν•λ‹¤.  
μ„λ²„ μ„Έμ…λ„ μΏ ν‚¤λ¥Ό μ‚¬μ©ν•΄μ„ μ„Έμ… IDλ¥Ό μ£Όκ³  λ°›λ”λ‹¤.
μ„λ²„λ” ν† ν° λ¬Έμμ—΄μ„ κ°’μΌλ΅ κ°–λ” μΏ ν‚¤λ¥Ό μ›Ή λΈλΌμ°μ €μ— μ‘λ‹µν•λ‹¤.  
μ›Ή λΈλΌμ°μ €λ” μ„λ²„κ°€ μ „μ†΅ν• μΏ ν‚¤λ¥Ό λ¨λ“  μ”μ²­μ— ν•¨κ» μ „μ†΅ν•λ―€λ΅ ν† ν°μ„ μ„λ²„μ— μ „μ†΅ν•κΈ° μ„ν•΄ λ³„λ„ μ½”λ“λ¥Ό μ‘μ„±ν•  ν•„μ”κ°€ μ—†λ‹¤.  

ν—¤λ”λ¥Ό μ‚¬μ©ν•  μλ„ μλ‹¤.  
μΏ ν‚¤λ„ ν—¤λ”λ¥Ό ν†µν•΄ μ „μ†΅λμ§€λ§ μΏ ν‚¤λ¥Ό μ μ™Έν• λ‹¤λ¥Έ ν—¤λ”λ¥Ό μλ―Έν•λ©°, ν—¤λ”λ¥Ό ν†µν•΄ ν† ν°μ„ μ „μ†΅ν•λ‹¤.  
ν΄λΌμ΄μ–ΈνΈλ” ν† ν°μ„ λ΅μ»¬μ— μ €μ¥ν–λ‹¤κ°€ μ„λ²„ API μ”μ²­μ„ νΈμ¶ν•  λ• ν—¤λ”λ¥Ό μ΄μ©ν•΄μ„ ν† ν°μ„ μ „μ†΅ν•λ‹¤.  

### β… ν† ν° λ³΄μ•

λ³΄μ•μ„ μ„ν•΄μ„ ν† ν°μ„ μ‚¬μ©ν•λ” λ§νΌ ν† ν° μμ²΄μ λ³΄μ•μ—λ„ μ‹ κ²½ μ¨μ•Ό ν•λ‹¤.  
μ„λ²„ λ³΄μ•μ„ μ² μ €ν ν•΄λ„ ν΄λΌμ΄μ–ΈνΈκ°€ λ³΄μ•μ— μ·¨μ•½ν•λ©΄ ν† ν°μ΄ νƒμ·¨λ  μ μκΈ° λ•λ¬Έμ΄λ‹¤.  
ν† ν°μ„ νƒμ·¨ν• ν΄λΌμ΄μ–ΈνΈλ” μ›λ ν† ν° μ†μ μμ²λΌ ν–‰μ„Έν•  μ μλ‹¤.  

- ν† ν° μ ν¨ μ‹κ°„ μ ν•
  - ν† ν° μƒμ„± μ‹μ μ„ κΈ°μ¤€μΌλ΅ μ ν• μ‹κ°„ λ‘κΈ°
  - λ§μ§€λ§‰ μ ‘κ·Ό μ‹κ°„μ„ κΈ°μ¤€μΌλ΅ ν† ν° μ ν¨ μ‹κ°„ μ„¤μ •ν•κΈ° (μ„λΈ”λ¦Ώ μ„Έμ…μ΄ μ΄ λ°©μ‹μ„ μ‚¬μ©ν•¨)

ν† ν° μ ν¨ μ‹κ°„μ€ λ„λ¬΄ μ§§μΌλ©΄ λ¶νΈν•κ³  λ„λ¬΄ κΈΈλ©΄ μ μ‹ μλ¦¬λ¥Ό λΉ„μ΄ μ‚¬μ΄ μ„ν—ν•  μ μλ‹¤.  

μ ν¨ μ‹κ°„κ³Ό ν•¨κ» ν΄λΌμ΄μ–ΈνΈ IP λ¥Ό λΉ„κµν•λ©΄ ν† ν° λ³΄μ•μ΄ ν–¥μƒλλ‹¤.  
ν† ν°μ„ μƒμ„±ν•  λ• μ ‘κ·Όν• ν΄λΌμ΄μ–ΈνΈ IP μ™€ μ‹¤μ  ν† ν°μ„ μ „μ†΅ν• ν΄λΌμ΄μ–ΈνΈ IP κ°€ κ°™μ€μ§€ λΉ„κµν•λ‹¤.  

λ³΄μ• μ‚¬κµ μν–¥μ„ μ¤„μ΄κ³  μ‹¶λ‹¤λ©΄ ν† ν°μ„ λ¬΄ν¨ν™”ν•΄μ„ κ°•μ λ΅ λ΅κ·Έμ•„μ›ƒμ‹ν‚¤λ” κΈ°λ¥λ„ ν•„μ”ν•λ‹¤.

### β… ν† ν° μ¬λ°κΈ‰

μΈμ¦κ³Ό μΈκ°€μ—μ„ μ‚¬μ©ν•λ” ν† ν°μΌλ΅ μ•΅μ„Έμ¤ ν† ν°<sup>access-token</sup>κ³Ό λ¦¬ν”„λ μ‹ ν† ν°<sup>refresh-token</sup>μ΄ μλ‹¤.  
λ§λ£ μ‹κ°„μ΄ μ§§μ€ μ•΅μ„Έμ¤ ν† ν°κ³Ό ν•¨κ» λ§λ£ μ‹κ°„μ΄ μƒλ€μ μΌλ΅ κΈ΄ λ¦¬ν”„λ μ‹ ν† ν°μ„ ν•¨κ» λ°κΈ‰ν• ν›„,  
μ•΅μ„Έμ¤ ν† ν°μ΄ λ§λ£λλ©΄ λ¦¬ν”„λ μ‹ ν† ν°μ„ μ΄μ©ν•΄μ„ μƒλ΅μ΄ μ•΅μ„Έμ¤ ν† ν°μ„ λ°κΈ‰ν•΄ μ¤€λ‹¤.  

### π― μΈκ°€μ™€ μ ‘κ·Ό μ μ–΄ λ¨λΈ



## π€ λ°μ΄ν„° μ•”νΈν™”



### π― λ‹¨λ°©ν–¥ μ•”νΈν™”



### π― μ–‘λ°©ν–¥ μ•”νΈν™”



## π€ HMACμ„ μ΄μ©ν• λ°μ΄ν„° κ²€μ¦



### π― HMAC μμ  μ½”λ“



## π€ λ°©ν™”λ²½μΌλ΅ ν•„μ”ν• νΈλν”½λ§ ν—μ©ν•κΈ°



## π€ κ°μ‚¬ λ΅κ·Έ(audit log) λ‚¨κΈ°κΈ°



## π€ λ°μ΄ν„° λ…Έμ¶ μ¤„μ΄κΈ°



## π€ λΉ„μ •μƒ μ ‘κ·Ό μ²λ¦¬



## π€ μ‹νμ–΄ μ½”λ”©



## π€ κ°μΈ λ³΄μ•

